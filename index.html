<!DOCTYPE html>
<html lang="ko">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* 간단한 CSS 스타일 */
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .question {
            background-color: #fff;
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        button {
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 20px 0;
            cursor: pointer;
            border-radius: 4px;
        }
        /* 커스텀 모달 스타일 */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <h1>Grit Test</h1>
    <form id="grit-test-form">
        <!-- 질문들이 여기에 동적으로 생성됩니다. -->
    </form>
    <button onclick="calculateGritScore()">Submit</button>
    <!-- 커스텀 모달 -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <span id="close">&times;</span>
            <p id="modal-text"></p>
        </div>
    </div>
    <script>
        var questions = [
            'New ideas and projects sometimes distract me from previous ones.',
            'Setbacks don’t discourage me. I don’t give up easily.',
            'I often set a goal but later choose to pursue a different one.',
            'I am a hard worker.',
            'I have difficulty maintaining my focus on projects that take more than a few months to complete.',
            'I finish whatever I begin.',
            'My interests change from year to year.',
            'I am diligent. I never give up.',
            'I have been obsessed with a certain idea or project for a short time but later lost interest.',
            'I have overcome setbacks to conquer an important challenge.'
        ];

        var form = document.getElementById('grit-test-form');

        questions.forEach(function(question, index) {
            var div = document.createElement('div');
            div.className = 'question';
            div.innerHTML = `
                <h2>Question ${index + 1}</h2>
                <p>${question}</p>
                <input type="range" min="1" max="5" value="3" name="question${index + 1}">
            `;
            form.appendChild(div);
        });

        function calculateGritScore() {
            var totalScore = 0;
            for (var i = 0; i < questions.length; i++) {
                var scoreElement = document.querySelector(`input[name="question${i + 1}"]`);
                if (!scoreElement) {
                    alert('Please answer all questions.');
                    return;
                }
                var score = scoreElement.value;
                if (isNaN(score)) {
                    alert('Score must be a number.');
                    return;
                }
                totalScore += parseInt(score);
            }
            var gritScore = totalScore / questions.length;
            var percentile = getPercentile(gritScore);
            showModal('Wow! Your Grit Score is ' + gritScore + '. That puts you in the top ' + percentile + '%. Keep up the good work!');
        }

        function getPercentile(gritScore) {
            var percentiles = [
                {score: 2.5, percentile: 10},
                {score: 3.0, percentile: 20},
                {score: 3.3, percentile: 30},
                {score: 3.5, percentile: 40},
                {score: 3.8, percentile: 50},
                {score: 3.9, percentile: 60},
                {score: 4.1, percentile: 70},
                {score: 4.3, percentile: 80},
                {score: 4.5, percentile: 90},
                {score: 4.7, percentile: 95},
                {score: 4.9, percentile: 99}
            ];
            for (var i = percentiles.length - 1; i >= 0; i--) {
                if (gritScore >= percentiles[i].score) {
                    return percentiles[i].percentile;
                }
            }
            return 0;
        }

        // 커스텀 모달을 보여주는 함수
        function showModal(text) {
            var modal = document.getElementById("myModal");
            var span = document.getElementById("close");
            document.getElementById("modal-text").innerText = text;
            modal.style.display = "block";
            span.onclick = function() {
                modal.style.display = "none";
            }
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
        }
    </script>
</body>
</html>